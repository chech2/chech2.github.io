<!DOCTYPE html> <html lang="ko-KR"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Eunsoo Kang" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Eunsoo Kang" /> <title> [리뷰] Training Compute-Optimal Large Language Models - Eunsoo Kang </title> <link rel="alternate" href="http://localhost:4000/chinchilla-scaling-laws/" hreflang="ko-KR" /> <link rel="canonical" href="http://localhost:4000/chinchilla-scaling-laws/" /> <meta name="description" content="Joy of Growth" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="[리뷰] Training Compute-Optimal Large Language Models | Eunsoo Kang" /> <meta property="og:title" content="[리뷰] Training Compute-Optimal Large Language Models | Eunsoo Kang" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/chinchilla-scaling-laws/" /> <meta property="og:description" content="Joy of Growth" /> <meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="[리뷰] Training Compute-Optimal Large Language Models | " /> <meta name="twitter:url" content="http://localhost:4000/chinchilla-scaling-laws/" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:description" content="Joy of Growth" /> <meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Eunsoo Kang" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/favicon.svg" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon.svg" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon.svg" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- for mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js?config=TeX-AMS-MML_HTMLorMML"></script> </head> <body data-theme="light" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Home</a><a class="menu-link" href="/archive/">Archive</a><a class="menu-link" href="/about/">About</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#nlp">NLP</a>, <a class="tag" href="/tags/#llm">LLM</a> </span> </div> <h1 class="header-title" itemprop="headline">[리뷰] Training Compute-Optimal Large Language Models</h1> <div class="post-meta"> <time datetime="2024-01-29T11:58:47+09:00" itemprop="datePublished"> Jan 29, 2024 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Eunsoo Kang</span> </span> <time hidden datetime="2024-01-29T11:58:47+09:00" itemprop="dateModified"> Jan 29, 2024 </time> <span hidden itemprop="publisher" itemtype="Person">Eunsoo Kang</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><p><a href="https://arxiv.org/abs/2203.15556">본 논문</a>은 2022년 3월에 발표되었다. 본 논문의 주요 목표는 주어진 컴퓨팅 예산에서 언어 모델을 훈련하기 위한 최적의 모델 크기와 토큰 수를 조사하는 것이다.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p><a href="https://arxiv.org/abs/2203.15556">본 논문</a>은 2022년 3월에 발표되었다. 본 논문의 주요 목표는 주어진 컴퓨팅 예산에서 언어 모델을 훈련하기 위한 최적의 모델 크기와 토큰 수를 조사하는 것이다.</p> <p>그동안 <a href="https://arxiv.org/abs/2001.08361">Scaling Laws</a>에 따라 모델의 매개변수 수와 성능 사이에 법칙 관계가 있음을 발견하고 점점 더 큰 규모의 모델을 훈련해왔다. 하지만 저자는 175B GPT-3, 280B Gopher 및 530B Megatron과 같은 현재의 LLM이 underfitting 되었다고 언급하며, 학습 토큰 수와 모델 크기를 동일하게 조정해야 한다고 주장한다.</p> <p>70M에서 16B 이상의 파라미터를 가진 400개 이상의 언어 모델을 5B에서 500B의 토큰으로 훈련한 결과, 컴퓨팅 최적화 훈련을 위해서는 모델 크기와 학습 토큰 수를 동일하게 확장해야 한다는 것을 발견했다. 즉, 모델 크기가 두 배가 될 때마다 학습 토큰 수도 두 배가 되어야 한다. 이를 검증하기 위해, 280B Gopher와 동일한 컴퓨팅 예산을 사용하면서도 70B 매개변수와 4배 더 많은 훈련 데이터를 포함하는 <strong>Chinchilla</strong>라는 새로운 LLM을 훈련하였다.</p> <center><img src="/assets/img/chinchilla/0.png" style="zoom: 65%;" /></center> <p><strong>Chinchilla</strong>는 다양한 다운스트림 태스크 평가에서 Gopher(280B), GPT-3(175B), Jurassic-1(178B), 및 Megatron(530B)보다 일관되고 유의미한 성능을 보였다.</p> <p>이 연구의 주요 질문은 <strong>“고정된 FLOPs 예산이 주어졌을 때, 모델 크기와 학습 토큰 수를 어떻게 조정해야 할까?”</strong>이다. 이를 위해 세 가지 접근 방식을 시도했는데, 먼저 컴퓨팅과 모델 크기 사이의 거듭제곱 관계를 가정하였다.</p> <p><br /></p> <h2 id="estimating-the-optimal-parametertraining-tokens-allocation"> <a href="#estimating-the-optimal-parametertraining-tokens-allocation" class="anchor-head"></a> Estimating the optimal parameter/training tokens allocation </h2> <h4 id="approach-1-fix-model-sizes-and-vary-number-of-training-tokens"> <a href="#approach-1-fix-model-sizes-and-vary-number-of-training-tokens" class="anchor-head"></a> Approach 1: Fix model sizes and vary number of training tokens </h4> <center><img src="/assets/img/chinchilla/1.png" style="zoom: 65%;" /></center> <p>첫 번째 접근 방식에서는 고정된 모델 크기(75M, 250M, 500M, 1B, 2.5B, 5B, 10B)에 대해 고정된 FLOPs로 학습 토큰 수를 변경하였다. 거듭제곱 법칙(\(N_{opt} \propto C^{a}\) 및 \(D_{opt} \propto C^b\))을 사용하여 Gopher의 컴퓨팅 예산(\(5.76 \times 10^{23}\))에 대한 최적의 모델 크기가 67B이며, 이에 대응하는 학습 토큰 수는 1.5T라는 것을 알아냈다.</p> <p><br /></p> <h4 id="approach-2-isoflop-profiles"> <a href="#approach-2-isoflop-profiles" class="anchor-head"></a> Approach 2: IsoFLOP profiles </h4> <center><img src="/assets/img/chinchilla/2.png" style="zoom: 65%;" /></center> <p>두 번째 접근 방식에서는 9개의 서로 다른 학습 FLOP (\(6 \times 10^{18}\) 에서 \(3 \times 10^{21}\) FLOPs 범위)으로 구성된 고정된 세트에 대해 모델 크기를 변경하고 각 지점에 대한 최종 학습 손실을 고려하였다. 이를 통해 <strong>“주어진 FLOP 예산에 대해 최적의 파라미터 수는 얼마인가?”</strong>에 대한 질문에 답하고자 하였다.</p> <p>각 IsoFLOPs 곡선에 포물선을 맞춰 최소 손실이 달성되는 모델 크기를 직접 추정하였다. 그런 다음, 이전 접근 방식과 마찬가지로 FLOP과 최적의 모델 크기 및 학습 토큰 수 사이에 거듭제곱 법칙(\(N_{opt} \propto C^{a}\) 및 \(D_{opt} \propto C^b\))을 적용하였다.</p> <p>이 접근 방식은 Gopher의 컴퓨팅 예산에 대한 최적의 모델 크기가 63B이고 학습토큰이 1.4T가 되어야 함을 시사한다.</p> <p><br /></p> <h4 id="approach-3-fitting-a-parametric-loss-function"> <a href="#approach-3-fitting-a-parametric-loss-function" class="anchor-head"></a> Approach 3: Fitting a parametric loss function </h4> <center><img src="/assets/img/chinchilla/3.png" style="zoom: 65%;" /></center> <p>세 번째 접근 방식에서는 위의 두 가지 접근 방식의 결과를 결합하여 모델 매개변수와 토큰 수의 매개변수 함수로 표현하고자 하였다. 이를 위해 함수형을 제안하고 Huber 손실을 최소화하여 Gopher Flop 예산에 대한 최적의 모델 크기를 40B 매개변수로 추정하였다.</p> <p><br /></p> <h2 id="chinchilla"> <a href="#chinchilla" class="anchor-head"></a> Chinchilla </h2> <p>섹션 3에 따르면 Gopher의 컴퓨팅 예산에 대한 최적의 모델 크기는 40B에서 70B 사이이다. 이를 검증하기 위해 1.4T 토큰의 데이터셋으로 70B 크기의 모델을 훈련하고 <strong>Chinchilla</strong>라고 명명하였다. 이후 이 모델을 Gopher 및 다른 LLM과 비교하여 성능을 평가하였다.</p> <p>Chinchilla를 학습시키는 데 사용되는 전체 하이퍼파라미터는 다음 표와 같다.</p> <center><img src="/assets/img/chinchilla/4.png" style="zoom: 65%;" /></center> <p><br /></p> <h3 id="results"> <a href="#results" class="anchor-head"></a> Results </h3> <center><img src="/assets/img/chinchilla/5.png" style="zoom: 65%;" /></center> <p>Chinchilla는 위의 Language Modeling 및 downstream task에서 평가하였다.</p> <p><br /></p> <h4 id="language-modeling"> <a href="#language-modeling" class="anchor-head"></a> Language Modeling </h4> <center><img src="/assets/img/chinchilla/6.png" style="zoom: 65%;" /></center> <p>그림 5는 The Pile이라는 모든 평가 데이터셋에 대한 결과를 Gopher와 비교한 결과이다. Chinchilla는 Gopher를 크게 능가하는 성능을 보여주고 있으며, Jurassic-1 (178B)과 비교했을 때도 두 개의 태스크(<u>dm_mathematics</u> 및 <u>ubuntu_irc</u>)를 제외한 모든 subset에서 Chinchilla가 우세한 것을 확인할 수 있다.</p> <p><br /></p> <h4 id="mmlu"> <a href="#mmlu" class="anchor-head"></a> MMLU </h4> <center><img src="/assets/img/chinchilla/7.png" style="zoom: 65%;" /></center> <p>MMLU는 모델의 멀티태스크 정확도를 측정하는 데이터셋으로, 인문학, 초등 수학, 역사, 컴퓨터 과학, 법률 등 57개의 주제를 포함하고 있다. 이 벤치마크에서 Chinchilla는 평균 정확도가 67.6%로, 훨씬 작은 크기에도 불구하고 Gopher를 크게 앞섰다. Gopher보다 7.6% 향상된 성능을 보였으며, 2023년 6월 전문가들이 예측한 정확도 63.4%를 능가하는 정확도를 기록하였다.</p> <p><br /></p> <h2 id="conclusion"> <a href="#conclusion" class="anchor-head"></a> Conclusion </h2> <p>최근 대규모 언어 모델 학습의 추세는 학습 토큰 수를 늘리지 않고 모델 크기를 늘리는 것이었다. 그러나 400회 이상의 훈련 결과를 바탕으로 세 가지 접근 방식을 제안하였고, 이를 통해 Gopher의 크기가 상당히 과대하다는 것을 확인하였다. 더 많은 데이터로 훈련된 더 작은 모델인 Chinchilla가 Gopher는 물론 더 큰 규모의 모델보다 성능이 뛰어난 것을 확인할 수 있었다.</p> <p>따라서 모델 크기를 계속해서 늘리는 것보다 데이터셋의 확장에 더 집중해야 하며, 데이터셋의 품질에 중점을 두고 책임감 있게 수집해야 한다. 또한 대규모 모델을 훈련하는 데는 많은 비용이 들기 때문에, 최적의 모델 크기를 계산하고 학습 단계를 미리 선택하는 것이 중요한데, <strong>Chinchilla Scaling Law</strong>는 대규모 언어 모델의 성능과 기능 향상을 위한 컴퓨팅 최적화 접근 방식을 제공한다.</p> <p><br /></p> </div> </article> </main> <small class="post-updated-at">updated_at 29-01-2024</small> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/LLaMA-1/" > <div class="nav-arrow">Previous</div> <span class="post-title">[리뷰] LLaMA: Open and Efficient Foundation Language Models</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="javascript::void(0)">resume</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2024</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
